---
title: "Competition_RegressionSRC"
author: "SRC"
date: "Thursday, April 16, 2015"
output: 
  html_document
    keep_md: yes
---

```{r hiddensetup, echo = FALSE}
require(ggplot2)
require(stringr)
require(plyr)
require(Hmisc)
require(texreg)
options(error=recover)
setwd("K:\\Development\\Competition")
# setwd("C:\\Users\\Greg Sanders\\Documents\\Development\\Fixed-price")
#setwd("C:/Users/scohen/My Documents/Competition/Competition/")
Path<-"K:\\2007-01 PROFESSIONAL SERVICES\\R scripts and data\\"
# Path<-"C:\\Users\\Greg Sanders\\SkyDrive\\Documents\\R Scripts and Data SkyDrive\\"
#path <- "C:/Users/scohen/My Documents/Competition/Competition/"
source(paste(Path,"lookups.r",sep=""))
layout(matrix(c(1,2,3,4),2,2))
```


```{r setup}
MCClist  <- read.csv(
    paste("data\\defense_mcc_competition_combined.csv", sep = ""),
    header = TRUE, sep = ",", dec = ".", strip.white = TRUE, 
    na.strings = c("NULL","NA",""),
    stringsAsFactors = TRUE
    )

MCClist$TotalValue<-MCClist$TotalValue
MCClist<-subset(MCClist,!MajorCommandID %in% c("ORG-2841",
"ORG-2776",
"ORG-4793",
"ORG-2849",
"ORG-2762",
"ORG-4020",
"ORG-2840",
"ORG-2757")
)

ggplot(data=MCClist,aes(x=pEffectiveComp))+geom_bar()
ggplot(data=MCClist,aes(x=sqrt(pEffectiveComp)))+geom_bar()
ggplot(data=MCClist,aes(x=log1p(pEffectiveComp)))+geom_bar()


names(MCClist)

LMsummaryLine<-function(fit,Unit=NULL){
    data.frame(  Equation=as.character(summary(fit)$call)[2],
        Source=as.character(summary(fit)$call)[3],
           Slope=coefficients(fit)[2:length(coefficients(fit))],
           SlopeStdError=summary(fit)$coefficients[2:length(coefficients(fit)),2],
           Intercept=coefficients(fit)[1],         
           AdjRsquared=summary(fit)$adj.r.squared,
            Pvalue=coef(summary(fit))[2:length(coefficients(fit)),4]
           #anova(fit)$'Pr(>F)'[1]


           )
    #Source: http://stackoverflow.com/questions/5587676/pull-out-p-values-and-r-squared-from-a-linear-regression
    #http://stackoverflow.com/questions/23838937/extract-pvalue-from-glm
}

```

Models with pProduct pService and pRnD

```{r PSR}
#
# fit <- lm(y ~ x1 + x2 + x3, data=mydata)

rcorr(as.matrix(subset(MCClist,select=c(pProduct,pService,pRnD))))

ggplot(data=MCClist,aes(x=pAir))+geom_bar(bin=0.01)
ggplot(data=MCClist,aes(x=sqrt(pAir)))+geom_bar(bin=0.01)
ggplot(data=MCClist,aes(x=log1p(pAir)))+geom_bar(bin=0.01)



ggplot(data=MCClist,aes(x=pService,y=pEffectiveComp))+geom_point()
fita <- lm(pEffectiveComp ~ pService, data=MCClist)
summary(fita)    
MCClist$pcService<-MCClist$pService-0.5

summary(MCClist$pcService)
plot(MCClist$pcService)

plot(MCClist$pcService)

ggplot(data=MCClist,aes(x=pcService,y=pEffectiveComp))+geom_point()
fitb <- lm(pEffectiveComp ~ pcService + I(pcService^2), data = MCClist)
summary(fitb)  
plot(fitb)


ggplot(data=MCClist,aes(x=pProduct,y=pEffectiveComp))+geom_point()
fitc <- lm(pEffectiveComp ~ pProduct, data=MCClist)
summary(fitc)   
plot(fitc)

fite <- lm(pEffectiveComp ~ pcService + I(pcService^2) +pRnD, data=MCClist)
summary(fite)
ggplot(data=MCClist,aes(x=pRnD,y=pEffectiveComp))+geom_point()
MCClist$pRnD[MCClist$pRnD<0]<-0
plot(MCClist$pRnD)

ggplot(data=MCClist,aes(x=log1p(pRnD),y=pEffectiveComp))+geom_point()
fitd <- lm(pEffectiveComp ~ pcService + I(pcService^2) + pRnD + sqrt(pRnD), data=MCClist)
summary(fitd)  
plot(fitd)
screenreg(list(fita, fitb, fitc, fite, fitd))

```

Observations:

1. pService is not statistically significant, and explains only 1% of the variation in pEffectiveComp
2. pcService is significant at the 5% level, explains 25% of the variation in pEffectiveComp and with a one unit increase increases pEffectiveComp by .15.
3. The plot of pcService mildly resembles a quadratic function. pcService^2 is significant at the .001 level and with pcService explains 25% of the variation in pEffectiveComp.  It istimates that an increase in pcService will result in a 1.25 increase in pEffectiveComp
4. pProduct is not statistically significant nor does it explain any of the variation in pEffectiveComp.  
5. pRnD is not statistically significant 
6.pRnD somewhat looks like a squareroot relationship And as can be seen in fitd, it impacts the model significantly thus it merits inclusion. 
7. sqrt(pRnD) is significant at the .05 level and the addition of these two variables increases r^2 from .25 to .35.  However, the standard error for sqrt(pRnD) is quite large (.32)

```{r Platform}

rcorr(as.matrix(subset(MCClist,select=c(pService,pRnD,pFnC,pAir,pVessel,pLand,pWnA,pMnS,pEnC))))
rcorr(cbind(MCClist$pFnC,MCClist$pService^2))


ggplot(data=MCClist,aes(x=pAir,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pAir),y=pEffectiveComp))+geom_point()

fita <- lm(pEffectiveComp ~ pcService, data=MCClist)
fitb <- lm(pEffectiveComp ~ pcService + I(pcService^2), data=MCClist)
fitd <- lm(pEffectiveComp ~ pcService + I(pcService^2) + pRnD, data=MCClist)
fite <- lm(pEffectiveComp ~ pcService + I(pcService^2) + pRnD+ sqrt(pRnD), data=MCClist)
afit <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir, data=MCClist)
plot(MCClist$pAir)
bfit <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+sqrt(pAir), data=MCClist) 
plot(afit)
summary(bfit) 
plot(bfit)
screenreg(list(fita, fitb, fitd, fite, afit, bfit))

```

Obersvations

1. pAir increases R^s by .02 and increases the coefficient of pcService^2 by .04 and also increases its significant to the 1% level.  PAir itself is not significant.  
2.the plot of pAir does not resemble a squareroot function.
3. sqrt(pAir) increases pcService^2 by .05, is not statistically significant and increases r^2 by .01.  Thus between these descriptive statistics and the plot of pAir, it should not be included further in the model. 

```{r pVessel with pProduct}
ggplot(data=MCClist,aes(x=pVessel,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pVessel),y=pEffectiveComp))+geom_point()

ggplot(data=MCClist,aes(x=pVessel))+geom_bar(bin=0.01)
ggplot(data=MCClist,aes(x=sqrt(pVessel)))+geom_bar(bin=0.01)
ggplot(data=MCClist,aes(x=log1p(pVessel)))+geom_bar(bin=0.01)

fitc <- lm(pEffectiveComp ~ pProduct, data=MCClist)
fit5 <- lm(pEffectiveComp ~ pProduct+ pRnD, data=MCClist)
fit6 <- lm(pEffectiveComp ~ pProduct+ pRnD+ sqrt(pRnD), data=MCClist)
fit7 <- lm(pEffectiveComp ~ pProduct+ pRnD+ sqrt(pRnD)+ pAir, data=MCClist)
fit1 <- lm(pEffectiveComp ~ pProduct+ pRnD+ sqrt(pRnD)+ pAir+ pVessel, data=MCClist)
summary(fitc)
summary(fit6)
summary(fit7)
summary(fit1) 
screenreg(list(fitc, fit5, fit6, fit7, fit1))
```

Observations:

1. pproduct is not significant in any of these models and in model 5 has p value of .7
2. r^2 increases from .05 to .27 when sqrt(pRnD) is added but doesn't fluctuate much after that.  

```{r pVessel with pService}
afit <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir, data=MCClist) 
fit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pVessel, data=MCClist)
fit8 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pVessel+ sqrt(pVessel), data=MCClist)
plot(MCClist$pVessel)
fit4 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pVessel+ sqrt(pVessel), data=MCClist[rownames(MCClist)!=58,])
summary(afit)
summary(fit2)
summary(fit8)
summary(fit4)
screenreg(list(afit, fit2, fit8, fit4))

```

Observations

1. pVessel does not change the r^2, the value or significance of pcService^2 nor is it significant
2. The plot of pVessel barely resembles a squareroot function.  sqrt(pVessel) does not change r^2, increases pcService by .09, and is not significant.
3. removing outliers decreases the value of sqrt(pVessel) by .78, does not increase significance, nor does it increase r^2 and it decreases pcService by .03.  It also has avery high standard error of .79


```{r pLand}

ggplot(data=MCClist,aes(x=pLand,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pLand),y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log1p(pLand),y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=pLand,y=pEffectiveComp))+geom_point()

bfit <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir, data=MCClist)  
afit1 <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pLand, data=MCClist)
summary(bfit)
summary(afit1) 
plot(afit1)
screenreg(list(bfit, afit1))

plot(MCClist$pLand)
afit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ sqrt(pAir)+ pLand+ sqrt(pLand), data=MCClist)
summary(afit2) 
plot(afit2)
screenreg(list(bfit, afit1, afit2))

```

Observations

1. Adding pLand does not change any coefficients or descriptive statistics and pair is not statistically significant 
2. pLand only very slightly resembles a square root function but since sqrt(pLand) increases r^2 by .02 and increases the coefficient of pcService^2 by .05 it should not be furhter described as one. 


```{r MnS}

ggplot(data=MCClist,aes(x=pMnS,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pMnS),y=pEffectiveComp))+geom_point()

bfit <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir, data=MCClist)  

bfit1 <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pMnS, data=MCClist)
summary(bfit1) 

bfit2 <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pMnS+ pVessel, data=MCClist)
summary(bfit)
summary(bfit1)
plot(bfit2)
screenreg(list(bfit, bfit1, bfit2))   

bfit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir, data=subset(MCClist,                                                                                    rownames(MCClist)!=58))
summary(bfit3) 
plot(bfit3)

bfit4 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pMnS, data=subset(MCClist,                                                                                    rownames(MCClist)!=58))
summary(bfit4)

bfit5 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pMnS+ pVessel, data=subset(MCClist,                                                                                    rownames(MCClist)!=58))
summary(bfit5)
screenreg(list(bfit, bfit1, bfit2, bfit3, bfit4, bfit5))

```

Observations

1. pMns increases the r^2 from .38 to .41, is significant at the 90% level (p=.0569), increases the p value for pcservice^2 by .003 and increases the significance of pRnD and sqrt(pRnD) to the 90% level
2. pMnS increases signifiance when pVessel is added when eliminating the outlier.  the coefficient of pcService^2 decreases by .05 when the outlier is removed.  The r^2 between model with outlier and model without does not change.  comparing the models with and without the outlier when pvessel, there is not much difference.  The biggest change to note here is the increase in significance of pMnS when accounting for the outlier and adding pVessel


```{r pWnA}


ggplot(data=MCClist,aes(x=pWnA,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pWnA),y=pEffectiveComp))+geom_point()

cfit1 <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pMnS, data=MCClist) 

cfit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA, data=MCClist)

cfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pMnS +pWnA, data=MCClist)
summary(cfit1)
summary(cfit3)
summary(cfit2)
screenreg(list(cfit1, cfit3, cfit2))

```

Observations:

1. Adding pWnA decreases the significance of pMnS.  Also, adding pWnA increases r^2 by .07.  Thus, including pMnS from now on should be discussed.  For now, I'm goign to not include it but it can always be added in if this logic is not sufficient. 
2. pWnA is statistically significant, increases r^2, decreases pcService^2 by .15.  Thus is should be continued further in the model.
3. pWnA is very siginificant (p=.005) and increases the r^2 of the model (.39->.46).  pMnS is kept in the first two models here to see if it changes at all with the addition of pWnA, since it doesn't, it will still be removed.  


```{r ElectronicAndCommunications}

ggplot(data=MCClist,aes(x=pEnC,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pEnC),y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log1p(pEnC),y=pEffectiveComp))+geom_point()

dfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir+ pRnD+ sqrt(pRnD)+ pWnA, data=MCClist)
summary(dfit1) 
plot(dfit1)

dfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir+ pRnD+ sqrt(pRnD)+ pWnA+ pEnC, data=MCClist)
summary(dfit2) 
plot(dfit2)
screenreg(list(dfit1, dfit2))

dfit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir+ pRnD+ sqrt(pRnD)+ pWnA +pEnC +pVessel, data=subset(MCClist, rownames(MCClist)!=58 ))
summary(dfit3) 
plot(dfit3)
screenreg(list(dfit1, dfit2, dfit3))
 
```

Observations

1. Adding pEnC does not influence r^2 significantly and it decreases the significance of pcService^2.  It is also not significant.
2. When looked at with vessel and romoving the outlier, neither nEnC nor pVessel is significant, the r^2 does not change.  
3. Adding pEnC decreases pcService^2 by .11. This could merit inclusion, **further discussion between team members would be helpful.**

```{r FacilityAndConstruction}

ggplot(data=MCClist,aes(x=pFnC,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=sqrt(pFnC),y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log1p(pFnC),y=pEffectiveComp))+geom_point()




efit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir+ pRnD+ sqrt(pRnD)+ pWnA, data=MCClist)
summary(efit1) 
plot(efit1)

efit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir + pRnD+ sqrt(pRnD)+ pWnA + pFnC, data=MCClist)
summary(efit2) 
plot(efit2)
screenreg(list(efit1, efit2))

efit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir+ pRnD+ sqrt(pRnD)+ +pWnA + pFnC+ pVessel, data=MCClist)
summary(efit3) 
plot(efit3)
screenreg(list(efit1, efit2, efit3))

efit4 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pAir+ pRnD+ sqrt(pRnD)+ pWnA + pFnC+ pVessel, data=subset(MCClist, rownames(MCClist)!=58 & rownames(MCClist)!=59 ))
summary(efit4) 
plot(efit4)
screenreg(list(efit1, efit2, efit3, efit4))

##the addition of pFnC increases r^2 by .02, increases coefficients pcService^2 by .05, decreases the significance of sqrt(pRnD) and does not change the other variables significantly.  when vessel is added, r^2 does not change, and neither do any other coefficients to a large extent.  When the outlier is eliminated, the sign of pVessel changes to positive and increases by .51, however, it is not significant (p=.376).  thus, I do not think pFnC should continue as part of the model.  
```

Observations:

1. The addition of pFnC increases r^2 by .01, increases coefficient on pcService^2 by .05, decreases the significance of sqrt(pRnD) and does not change the other variables significantly.  
2. When Vessel is added, r^2 does not chagne, and neither do any other coefficients to a large extent.  
3. When the outlier is eliminated, the sign of pVessel changes to positive and increases by .51, however, it is not significant (p=.376).  
4.  This leads me to say that pFnC should not be included in the model


```{r IDV}
rcorr(as.matrix(subset(MCClist,select=c(pService,pRnD,pAir,pLand,pWnA,pMnS,pEnC,pIDV,pFixed,pCostPlus,pIncentFee))))


ggplot(data=MCClist,aes(x=pIDV,y=pEffectiveComp))+geom_point()

ffit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA, data=MCClist)
summary(ffit1) 
plot(ffit1)

ffit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=MCClist)
           
summary(ffit2) 
plot(ffit2)
screenreg(list(ffit1, ffit2))
##pIdv increases r^2 by .04, increases the coefficient of pcService^2 by .02, maintains statistically significant coefficients of the other variables and is itself statistically significant at the 90% level, thus IDV should be included in the model.  
```

Observations:

1. pIdv increases r^2 by .03, increases the coefficient of pcService^2 by .02, maintains statisticaly significant coefficients on the other variables and is itsefl statistically significant at the 90% level, thus IDV should be included in the model.


```{r FixedPrice}
ggplot(data=MCClist,aes(x=pFixed,y=pEffectiveComp))+geom_point()

gfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=MCClist)

gfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ pIDV+ pFixed, data=MCClist)
summary(gfit1) 
plot(gfit1)
screenreg(list(gfit2, gfit1))

```


Observations:

1. With the addition of pFixed, the r^2 increases by .01, the coefficient of pcService does not change and pFixed is not statistically significant.  Thus, pFixed should not be included further on. 


```{r CostPluse}
ggplot(data=MCClist,aes(x=pFixed,y=pEffectiveComp))+geom_point()

hfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=MCClist)
summary(hfit1) 
plot(hfit1)

hfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ pCostPlus, data=subset(MCClist,!rownames(MCClist) %in% c(59) ))
summary(hfit2) 
plot(hfit2)
screenreg(list(hfit1, hfit2)) 
```

Observations:

1.pCost plus also does not change any of the descriptive statistics very signficantly and itself is not statistically significant.  The only interesting change is a decrease in r^2 by .05

```{r IncentiveFee}

ifit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=MCClist)
summary(ifit1) 
plot(ifit1)

ifit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ pIncentFee, data=MCClist)
summary(ifit2) 
plot(ifit2)
screenreg(list(ifit1, ifit2))

##the addition of incentive fee into the model does not change any of the coefficients of the other variables to a meaningful extent and does not change the r^2 value, thus it will not be continued in the model.  

```

Observations:

1. the addition of incentive fee into the model does not significantly change any of the coefficients of the other variables in a meaningful way and does not change the r^2 value very much (+.01), thus it will not be included.

```{r TotalCount}

rcorr(as.matrix(subset(MCClist,select=c(pService,pRnD,pAir,pLand,pWnA,pMnS,pEnC,pIDV,TotalCount,TotalValue,avSize))))

ggplot(data=MCClist,aes(x=TotalCount))+geom_bar()
ggplot(data=MCClist,aes(x=log(TotalCount)))+geom_bar()
ggplot(data=MCClist,aes(x=TotalCount,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log(TotalCount),y=pEffectiveComp))+geom_point()

jfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=MCClist)
summary(jfit1)
plot(jfit1)


ggplot(data=MCClist,aes(x=TotalCount))+geom_bar()
ggplot(data=MCClist,aes(x=log(TotalCount)))+geom_bar()
ggplot(data=MCClist,aes(x=TotalCount,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log(TotalCount),y=pEffectiveComp))+geom_point()

jfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ TotalCount, data=MCClist)
summary(jfit2)
plot(jfit2)

jfit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalCount), data=MCClist)
summary(jfit3)
screenreg(list(jfit1, jfit2, jfit3))


```

Observations:

1.total count does not change the model in anyway, and it's interesting to note that its coefficients are zero.
2. Log of total count decreases the coefficient on pcservice^2 by .04 


```{r TotalValue}

rcorr(as.matrix(subset(MCClist,select=c(pService,pRnD,pAir,pLand,pWnA,pMnS,pEnC,pIDV,TotalCount,TotalValue,avSize))))

ggplot(data=MCClist,aes(x=TotalValue))+geom_bar()
ggplot(data=MCClist,aes(x=log(TotalValue)))+geom_bar()
ggplot(data=MCClist,aes(x=TotalValue,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log(TotalValue),y=pEffectiveComp))+geom_point()

kfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=MCClist)

kfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue), data=MCClist)
summary(kfit2)
plot(kfit2)

kfit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue) + log(TotalValue):I(pcService^2), data=subset(MCClist, rownames(MCClist)!=26))
summary(kfit3)
plot(kfit3)

kfit4 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue), data=subset(MCClist, rownames(MCClist)!=26))
summary(kfit4)
plot(kfit4)

kfit5 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue), data=subset(MCClist, rownames(MCClist)!=26&rownames(MCClist)!=58))
summary(kfit5)
plot(kfit5)


screenreg(list(kfit1, kfit2, kfit3, kfit4, kfit5)) 
```

Observations:

1. log(Total value) decrease the coefficient of pcService^2 by .06, is not statistically significant and does not change the r^2 value significantly.
2. I(pcService^2):log(TotalValue) decreases the significance of service coefficients, does not change r^2 and itself is not significant.
3. Subsetting the data frame in models 4 and 5 do not change r^2, significances of other coefficient nor does it change any coefficients in either direction. 
4. Thus, out of these models, kfit2 (including log(TotalValue)) should be continued as the base model.


```{r AverageSize}

lfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue), data=MCClist)
summary(lfit1)

lfit2 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue)+ avSize, data=MCClist)
summary(lfit2) 
plot(lfit2)


lfit3 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ pIDV+ log(TotalValue)+ lavSize, data=MCClist)
summary(lfit3) 
plot(lfit3)

rcorr(as.matrix(subset(MCClist,select=c(pService,pRnD,pAir,pLand,pWnA,pMnS,pEnC,pIDV,TotalCount,TotalValue,avSize))))

ggplot(data=MCClist,aes(x=avSize))+geom_bar()
ggplot(data=MCClist,aes(x=log(avSize)))+geom_bar()
ggplot(data=MCClist,aes(x=avSize,y=pEffectiveComp))+geom_point()
ggplot(data=MCClist,aes(x=log(avSize),y=pEffectiveComp))+geom_point()

lfit4 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue)+ log(avSize), data=MCClist)
summary(lfit4)
plot(lfit4)

lfit5 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ pIDV+ log(TotalValue)+ log(avSize), data=subset(MCClist, rownames(MCClist)!=26))
summary(lfit5)
plot(lfit5)


lfit6 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ pIDV+ log(TotalValue)+ log(avSize)+ pVessel, data=subset(MCClist, rownames(MCClist)!=26&rownames(MCClist)!=59))
summary(lfit6)
plot(lfit6)


lfit7 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ log(TotalValue)+ log(avSize)+ pVessel+ pIDV:I(pcService^2), data=MCClist)
summary(lfit7) 
plot(lfit7)


lfit8 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ log(TotalValue)+ log(avSize)+ pVessel + pIDV:I(pcService^2)+ pIDV:pcService, data=MCClist)
summary(lfit8) 
plot(lfit8)
screenreg(list(lfit1, lfit2, lfit3, lfit4, lfit5, lfit6, lfit7, lfit8))

```

Observations:

1. adding average size as no impact on the model and itself is not significant
2.  Adding log(avSize) increases the coefficient on pcService^2 by .01 and and doesn't affect r^2.  It itself is not significant.
3. The rest of the additions/modifications do not contribute in a way that merits further inclusion.
4. Because log(avSize) does not change the r^2, is itself not significant and only changes the coefficient of pcService^2 by .04 I do not think it should continue.   
5. Model 6 decreases r^2 by .08 and decreases the significance and value of pWnA by .23.  This model adds I(pcService^2):pIDV

```{r StateValidation}
mfit1 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue), data=MCClist)
summary(mfit1) 
plot(mfit1)


StateList  <- read.csv(
    paste("data\\defense_state_competition_combined.csv", sep = ""),
    header = TRUE, sep = ",", dec = ".", strip.white = TRUE, 
    na.strings = c("NULL","NA",""),
    stringsAsFactors = TRUE
    )
names(StateList)

StateList <-subset(StateList ,!PoPstateCode %in% c("VI",
"AS",
"MP",
"AE",
"PW",
"US",
"UK",
"GM",
"GB",
"JA",
"ON",
"QC",
"   ",
"BC"))

rcorr(as.matrix(subset(StateList,select=c(pService,pProduct,pRnD,pAir,pLand,pVessel,pWnA,pFnC,pMnS,pEnC,pIDV,pFixed,pCostPlus,TotalCount,TotalValue,avSize))))


StateList$pcService<-StateList$pService-0.5
mfit2 <- lm(pEffectiveComp ~ pcService + I(pcService^2) + pRnD+ sqrt(pRnD), data=StateList)
summary(mfit2) 
plot(mfit2)

screenreg(list(mfit1, mfit2))

##using statelist certainly yields very different results. 

mfit3 <- lm(pEffectiveComp ~ pcService + I(pcService^2), data=StateList)
summary(fit) 
plot(fit)


mfit4 <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+sqrt(pAir), data=StateList)
summary(mfit4) 
plot(mfit4)


mfit5 <- lm(pEffectiveComp ~ pProduct+ pRnD+ sqrt(pRnD)+ pAir+ pVessel, data=StateList)
summary(mfit5) 
plot(mfit5)

mfit6 <- lm(pEffectiveComp ~ pcService+I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pLand, data=StateList)
summary(mfit6) 
plot(mfit6)

mfit7 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pMnS, data=StateList)
summary(mfit7) 
plot(mfit7)


mfit8 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pMnS +pWnA, data=StateList)
summary(mfit8) 
plot(mfit8)


mfit9 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV, data=StateList)
summary(mfit9) 
plot(mfit9)


mfit10 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir+ pWnA+ pIDV+ pFixed, data=StateList)
summary(mfit10) 
plot(mfit10)
screenreg(list(mfit1, mfit2, mfit3, mfit4, mfit5, mfit6, mfit7, mfit8, mfit9, mfit10))

mfit11 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+pCostPlus, data=StateList)
summary(mfit11)

mfit12 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ pIncentFee, data=StateList)
summary(mfit12)


mfit13 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ TotalCount, data=StateList)


mfit14 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue), data=StateList)

mfit15 <- lm(pEffectiveComp ~ pcService+ I(pcService^2)+ pRnD+ sqrt(pRnD)+ pAir + pWnA + pIDV+ log(TotalValue)+ log(avSize), data=StateList)

screenreg(list(mfit1, mfit2, mfit3, mfit4, mfit5, mfit6, mfit7, mfit8, mfit9, mfit10, mfit11, mfit12, mfit13, mfit14, mfit15))


```

